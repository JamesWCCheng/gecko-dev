<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <title id = "title">TestPref test</title>


</head>

<body>
<script>
        funcInit = function(){
            // After DOM has been loaded....
            console.log("DOM has been loaded...");
            var btnElement = document.querySelector('#btn');
            btn.addEventListener('click', clickHandler);

        }
        document.addEventListener('DOMContentLoaded', funcInit);
        var h = navigator.mypref;
        console.log(h.helloStr);
         h.addEventListener('complete', function (e) {
                console.log("OnComplete");
                console.log("isComplete = " + e.isComplete);
                console.log("percentage = " + e.percentage);
                console.log("msg = " + e.msg);
                document.getElementById("msg").innerHTML = e.msg;
                document.getElementById("per").innerHTML = e.percentage;
            });
             h.addEventListener('error', function (e) {
                console.log("OnError");
                console.log("isComplete = " + e.isComplete);
                console.log("percentage = " + e.percentage);
                console.log("msg = " + e.msg);
                document.getElementById("msg").innerHTML = e.msg;
                document.getElementById("per").innerHTML = e.percentage;
            });
              h.addEventListener('progress', function (e) {
                console.log(e);
                console.log("OnProgress");
                console.log("isComplete = " + e.isComplete);
                console.log("percentage = " + e.percentage);
                console.log("msg = " + e.msg);
                document.getElementById("msg").innerHTML = e.msg;
                document.getElementById("per").innerHTML = e.percentage;
            });
        console.log("test page is starting...");
         window.addEventListener('progress', function (e) {
                 console.log("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
            });
        var clickHandler = function(){
            console.log("click trigger");

             var h2 = new Hello('Test STR');
               console.log(h2);
           
            // window.addEventListener('click', function (e) {
            //      console.log("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");
            // });
          
            console.log(h.hello.add(1, 3));

            console.log(h);


            h.sort([1,3,2,45,5]).then(function (result) {
                console.log(result);

            });
            //var h2 = new TestPref('Test STR');
            //var h = new TestPref("Init in JS");
           
            //      h2.addEventListener('complete', function () {
            //     console.log("OnComplete");
            // });
            //  h2.addEventListener('error', function () {
            //     console.log("OnError");
            // });
            //   h2.addEventListener('progress', function () {
            //     console.log("OnProgress");
            // });
            console.log("sayTestPref : " + h.sayHello());

            console.log("TestPrefStr : " + h.helloStr);
            h.helloStr = null;
            console.log("TestPrefStr : " + h.helloStr);
            h.helloStr = "Be modified by web";
            console.log("TestPrefStr : " + h.helloStr);

            console.log("readonlyStr : " + h.readonlyStr);
            h.readonlyStr = "Also be modified by web";
            console.log("readonlyStr : " + h.readonlyStr);

            //var x2 = h2.randNum();
            var x = h.randNum();
            console.log("Random num = ", x);
            var y = x;
            console.log(x + " + " + y + " = " + h.add(x,y));
            console.log(x + " - " + y + " = " + h.sub(x,y));
            console.log(x + " * " + y + " = " + h.mul(x,y));
            try{
                console.log(x + " / " + y + " = " + h.div(x,y));
                y = 0;
                console.log(x + " / " + y + " = " + h.div(x,y));
            }catch(err){
                console.log(err);
                if(err.name == "NS_ERROR_ILLEGAL_VALUE"){
                    console.log("Can NOT divide by zero!");
                }
            }finally{
                console.log("Finish testing");
            }
        }

    </script>
    <H1 id = "per">Test Page</H1>
    <p id="msg">Click the button to trigger timer.</p>

    <button id="btn">click me</button>

    <iframe src="http://www.w3schools.com">
         <p>Your browser does not support iframes.</p>
    </iframe>
</body>
</html>